<!-- pasos para la solicitud -->
<p-steps [styleClass]="stepsModel.styleClass" [model]="stepsModel.steps" [(activeIndex)]="stepsModel.activeIndex"></p-steps>

<!-- Paso 1 nomenclatura-->
<ng-container *ngIf="stepsModel.activeIndex === stepsModel.STEP_UNO">

  <p-panel styleClass="mb-2 steps-pnl">
    <p-header>
      <div class="ui-g">
        <div class="ui-g-6 p-0">
          <i class="fa fa-info-circle font-size-18"></i>
          <span> Seleccione la Nomenclatura</span>
        </div>
        <div *ngIf="nomenclaturasOrigen && nomenclaturasOrigen.length > 5" class="ui-g-6 p-0">
          <input type="text"
            (keyup)="busquedaNomenclatura()"
            [(ngModel)]="filterValue"
            maxlength="15"
            adminAutofocus
            autocomplete="off"
            placeholder="Busqueda Nomenclatura"
            class="ad-input ad-input-style w-100 pt-0" />
          <div class="focus-border"></div>
        </div>
      </div>
    </p-header>

    <!-- Hay nomenclaturas-->
    <ng-container *ngIf="nomenclaturasOrigen && nomenclaturasOrigen.length > 0">

      <!-- tabla - nomenclaturas -->
      <p-table
        id="tblNomen"
        #tblNomen
        [value]="nomenclaturasView"
        [(selection)]="nomenclaturaSel"
        [alwaysShowPaginator]="false"
        [responsive]="true"
        [paginator]="true"
        [rows]="5"
        rowHover="true"
        selectionMode="single">

        <ng-template pTemplate="header">
          <tr class="text-center">
            <th style="width: 5%">Nomenclatura</th>
            <th>Descripción</th>
            <th style="width: 4%">Detalle</th>
          </tr>
        </ng-template>

        <ng-template pTemplate="body" let-nomenclatura>
          <tr [pSelectableRow]="nomenclatura">
            <td class="text-center font-size-14">
              <strong>{{ nomenclatura.nomenclatura }}</strong>
            </td>
            <td>{{ nomenclatura.descripcion }}</td>
            <td class="text-center">
              <button type="button" (click)="verDetalleNomenclatura($event, nomenclatura)" class="btn btn-sm btn-round-table btn-pup">
                <i class="pi pi-external-link icon-round-table"></i>
              </button>
            </td>
          </tr>
        </ng-template>

        <ng-template pTemplate="emptymessage">
          <tr>
            <td [attr.colspan]="6">
              <p class="st font-weight-bold font-size-14 mb-0 text-center">No hay nomenclaturas de acuerdo al filtro de búsqueda ingresado</p>
            </td>
          </tr>
        </ng-template>
      </p-table>

      <!-- botones - next-->
      <div class="text-center mt-2 mb-1">
        <button (click)="siguienteNomenclatura()" type="button" class="btn btn-sm btn-primary w-100-px" [disabled]="!nomenclaturaSel">
          <label class="btn-size-admin">Siguiente <i class="fa fa-hand-o-right"></i></label>
        </button>
      </div>
    </ng-container>

    <!-- No Hay nomenclaturas-->
    <div *ngIf="!(nomenclaturasOrigen && nomenclaturasOrigen.length > 0)" class="mr-4 ml-4 ui-messages ui-widget ui-corner-all ui-messages-warn mt-2">
      <span class="ui-messages-icon pi pi-exclamation-triangle"></span>
      <span class="ui-messages-detail">
        <strong>No hay nomenclaturas</strong> parametrizadas en el sistema
      </span>
    </div>
  </p-panel>
</ng-container>

<!-- Paso 2 entrada informacion-->
<ng-container *ngIf="stepsModel.activeIndex === stepsModel.STEP_DOS">

  <p-panel styleClass="mb-2 steps-pnl">
    <p-header>
      <div class="ui-g">
        <div class="ui-g-6 p-0">
          <p>
            <i class="fa fa-info-circle font-size-22"></i>
            Ingrese la información solicitada
          </p>
        </div>
        <div class="ui-g-6 p-0 text-right">
          <p>
            <span (click)="verDetalleNomenclatura($event, nomenclaturaSel)" class="edit-round-min btn-pup">
              <i class="pi pi-external-link del-round-min-pi"></i>
            </span> Nomenclatura: <span style="color: #F25423">{{nomenclaturaSel.nomenclatura}}</span>
          </p>
        </div>
      </div>
    </p-header>



    <!-- campos de informacion-->
    <admin-campos-informacion [campos]="campos"></admin-campos-informacion>

    <!-- botones regresar - next-->
    <div class="text-center mt-2 mb-1">
      <button (click)="stepsModel.regresar()" type="button" class="btn btn-sm btn-secondary w-100-px mr-2">
        <label class="btn-size-admin"><i class="fa fa-hand-o-left"></i> Regresar</label>
      </button>
      <button type="button" class="btn btn-sm btn-primary w-100-px">
        <label class="btn-size-admin">Siguiente <i class="fa fa-hand-o-right"></i></label>
      </button>
    </div>
  </p-panel>
</ng-container>

<!-- modal ver detalle nomenclatura -->
<ng-container *ngIf="detalleNomenclatura && detalleNomenclatura.data">
  <p-dialog header="Detalle de la Nomenclatura"
  [(visible)]="detalleNomenclatura.isShowModal"
  modal="true"
  responsive="true"
  dismissableMask="true"
  styleClass="splr-dl"
  (onHide)="detalleNomenclatura.closeModal()">
    <div class="mx-dtl-mdl">
      <admin-detalle-nomenclatura [detalle]="detalleNomenclatura.data"></admin-detalle-nomenclatura>
    </div>
  </p-dialog>
</ng-container>
